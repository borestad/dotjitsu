#!/usr/bin/env dash

hr
echo "ğŸ¦„ Bump files"
# Show stat


# If we've already have staged files, use them.
if [ $(git diff --staged --stat | wc -l) -gt 0 ]; then
  echo "ğŸ¦„ Found already staged files"
  echo
  git diff --staged --stat
else
  git add . --verbose
fi



echo
echo "ğŸ¦„ Commit files"
echo

filename=''
stats=$(git diff --cached --shortstat | sed -E 's/ (insertions?|deletions?|changed?)//g' | sed 's/,//g' | xargs)
DATE=$(date '+%Y-%m-%d %H:%M:%S')

if [ $(git diff --cached --numstat | wc -l) -eq 1 ]; then
  # Only one file changed
   filename=$(basename $(git diff --cached --numstat --name-only))
   stats=$(echo $stats | sed 's/1 file//g' | xargs)

   git commit -m "\`ï¸ï¸âš¡ï¸ BUMP âš¡ï¸\`  \`$filename $stats\`" -a || true
else
  git commit -m "\`ï¸ï¸âš¡ï¸ BUMP âš¡ï¸\`  \`$stats\`" -a || true
  echo
fi

echo $filename
echo $stats

# git commit -m "ğŸ¦„ \`$DATE\`  \`$stats\`" -a || true
# git commit -m "\`ï¸ï¸âš¡ï¸ BUMP âš¡ï¸\`  \`$stats\`" -a || true

# hr
# echo "âœ¨ Push files\n"
# ~/.dotjitsu/bin/push
