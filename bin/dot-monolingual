#!/usr/bin/env bash


echo ''; hr - '#' -
echo "[CLEANING LANGUAGES]"
echo

dfc
echo

echo "Finding all *.lproj in $(pwd)"
# Keep sv|en|en_GB|.lproj

# Truncate lines
tput rmam

REGEX='.*(ar|ca|cs|da|de|el|en_AU|es|es_\w+|fi|fr|fr_\w+|he|hi|hr|hu|id|it|ja|ko|ms|nl|no|pl|pt|pt_\w+|ro|ru|sk|th|tr|uk|vi|zh_\w+|German|French|Japanese|Italian|Spanish|Dutch)\.lproj$'
#sudo gfind "$(pwd)" -type d -regextype posix-egrep -regex $REGEX -print0 | sudo gxargs -r0 -- rm -rv
rm -f /tmp/dot-monolingual
sudo gfind / -type d ! -path "*/Volumes/*" ! -path "*/System/Volumes/*" -regextype posix-egrep -regex $REGEX -exec rm -rfv {} + 2>&1 | tee /tmp/dot-monolingual
#sudo gfind $(pwd) -type d -regextype posix-egrep -regex $REGEX >| /tmp/dot-monolingual

#sudo gfind / -type d -regextype posix-egrep -regex '.*(ar|ca|cs|da|de|el|en_AU|es|es_419|fi|fr|fr_CA|he|hi|hr|hu|id|it|ja|ko|ms|nl|no|pl|pt|pt_PT|ro|ru|sk|th|tr|uk|vi|zh_CN|zh_HK|zh_TW|German|French|Japanese|Italian|Spanish|Dutch)\.lproj$' -delete


sudo gfind / -type d -regextype posix-egrep -regex $REGEX -print0 | while read -d $'\0' file; do
  #echo $file
  echo "$((COUNTER++)) $file"
	# bundleid=`/usr/libexec/PlistBuddy -c Print:CFBundleIdentifier "$file" 2>&1`
	# rc=$?
	# if [[ $rc == 0 ]]; then
	# 	# echo "<dict><key>architectures</key><true/><key>bundle</key><string>$bundleid</string><key>languages</key><true/></dict>"
  #   echo $rc
  #   echo 'hello'
	# fi
done

echo
dfc

#find ~/code -type d -name node_modules | xargs rm -rfv
#rm -rfv ~/.tmp/*

#npm cache clean --force
#yarn cache clean

# brew uninstall --force brew-cask;
# brew untap phinze/cask;
# brew untap caskroom/cask;
# brew update;
# brew cleanup;
# brew cask cleanup
