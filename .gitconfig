# Sample gitconfig
#
# https://github.com/skwp/dotfiles/blob/master/git/gitconfig

############################################################
# Includes
############################################################

[include]
	path = ~/.private/.gitconfig-user
	path = ~/.dotjitsu/.gitconfig-alias

[includeIf "gitdir:~/work/"]
    path = ~/.private/.gitconfig-work

############################################################
# Core / init
############################################################

[core]
	attributesfile = ~/.gitattributes
	autocrlf = input
	commitGraph = true
	compression = 1
	pager = delta
	editor = micro
	excludesfile = ~/.gitignore
	fsmonitor = true
	ignorecase = false
	preloadindex = true
	packedGitLimit = 1512m
	packedGitWindowSize = 1512m
	quotepath = false
	fscache = true

[transfer]
	compression = 1

[pack]
	compression = 6
	threads = 16
	useZstd = true
	deltaCacheSize = 256m
	windowMemory = 256m
	allowPackReuse = true
	writeReverseIndex = true

[init]
	templatedir = ~/.dotjitsu/packages/git/templates
	defaultBranch = main

############################################################
# Color / format / log
############################################################

[color]
	ui = true

[color "branch"]
	current = yellow reverse
	local = yellow
	remote = green

[color "diff"]
	meta = yellow
	frag = magenta bold
	old = red bold
	new = green bold
	commit = yellow bold
	whitespace = red reverse

[color "diff-highlight"]
	oldNormal = red bold
	oldHighlight = red bold 52
	newNormal = green bold
	newHighlight = green bold 22

[format]
	pretty = format:%C(blue)%ad%Creset %C(yellow)%h%C(green)%d%Creset %C(blue)%s %C(magenta) [%an]%Creset

[log]
  # Use abbrev SHAs whenever possible/relevant instead of full 40 chars
  abbrevCommit = true
#   date = iso

[grep]
	extendRegexp = true
	lineNumber = true

[branch]
	autosetuprebase = always  # track remote and rebase by default

[help]
	autocorrect = 1           # aggressively auto-correct mistyped git commands

############################################################
# Delta / diff / difftool / merge
############################################################

[interactive]
    diffFilter = delta --color-only

[delta]
	features = side-by-side line-numbers decorations omit-code-fragment
	true-color = always
    whitespace-error-style = 22 reverse
    line-numbers = true
	paging = never
	navigate = true
    hyperlinks = true
    hyperlinks-file-link-format = "vscode://file/{path}:{line}"
    zero-style = dim syntax
	theme = 1337

[delta "decorations"]
    commit-decoration-style = bold yellow box ul
    file-style = bold yellow ul
    file-decoration-style = none

    # hunk-header-style = line-number omit-code-fragment
	# hunk-header-decoration-style = none
    # hunk-header-file-style = red
    # hunk-header-line-number-style = "#067a00"
    # hunk-header-style = none

[diff]
	colorMoved = default
    tool = smartsynchronize
	context = 1

[difftool]
	prompt = false
	colorMoved = default

[difftool "smartsynchronize"]
    cmd = /Applications/SmartSynchronize.app/Contents/MacOS/SmartSynchronize $LOCAL $REMOTE

[merge]
	conflictStyle = zdiff3

############################################################
# Fetch / pull / protocol / HTTP
############################################################

[fetch]
	prune = true
	pruneTags = true

[pull]
	# rebase = true
	ff = only
	prune = true
	twohead = ort # https://git-scm.com/docs/merge-strategies#Documentation/merge-strategies.txt-ort

[http]
	# Increase HTTP buffer to avoid issues with very large pushes
	postBuffer = 524288000

[push]
	recurseSubmodules = check  # refuse push if submodule commits aren't pushed
	# See `git help config` (search for push.default) for other modes
	default = simple
	autoSetupRemote = true

[protocol]
	version = 2

############################################################
# Commit / rebase / stash / index
############################################################

[commit]
	gpgSign = false
	verbose = true

[rebase]
	stat = true
	autostash = true
	autosquash = true

[stash]
	showPatch = true        # show diff when stashing changes

[index]
	threads = true          # speed up index operations on multi-core

[advice]
	statusHints = off
	skippedCherryPicks = false

[apply]
	whitespace = nowarn     # don't warn on whitespace in patches

[rerere]
	# Remember previous conflict resolutions and reuse them
	enabled = true

############################################################
# Submodules / GC / LFS
############################################################

[submodule]
	recurse = true
	fetchJobs = 10

[gc]
	autoDetach = false
	writeCommitGraph = true
	auto = 0

[filter "lfs"]
	clean = git-lfs clean -- %f
	smudge = git-lfs smudge -- %f
	process = git-lfs filter-process
	required = true

############################################################
# Credentials / URLs / Hub
############################################################

[credential "https://gametechgit.gamesglobal.com"]
	provider = generic

# Problematic with mise
# [remote "origin"]
# 	tagopt = "--tags -f"

[credential "https://github.com"]
	helper =
	helper = !/opt/homebrew/bin/gh auth git-credential

[credential "https://gist.github.com"]
	helper =
	helper = !/opt/homebrew/bin/gh auth git-credential

[url "ssh://github.com/"]
	pushInsteadOf = https://github.com/

[url "ssh://gitlab.com/"]
	pushInsteadOf = https://gitlab.com/

[hub]
	protocol = https

############################################################
# Tools / UI / Git-flow / Tags / Misc
############################################################

[tig]
	line-graphics = yes # Disable graphics characters
	tab-size = 4        # Number of spaces per tab
	mouse = no

[gui]
	pruneDuringFetch = true

# Git-flow style branching, with main as master-equivalent
[gitflow "branch"]
	develop = develop
	master = main

[gitflow "prefix"]
	feature = feature/
	release = release/
	hotfix = hotfix/
	support = support/
	versiontag = v

[smartgit "submodule"]
	fetchalways = false
	update = true
	initializenew = true

[diff-so-fancy]
	first-run = true

[ghq]
	root = ~/code

[taggrouping]
	groups =
	singles =

[tag]
  # Sort tags as version numbers whenever applicable, so 1.10.2 is AFTER 1.2.0.
  sort = version:refname

[versionsort]
  prereleaseSuffix = -pre
  prereleaseSuffix = .pre
  prereleaseSuffix = -beta
  prereleaseSuffix = .beta
  prereleaseSuffix = -rc
  prereleaseSuffix = .rc
